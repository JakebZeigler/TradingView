//@version=5
indicator("Max Difference Highlighter", overlay=true)

// Calculate the difference between high and low for each bar
diff = high - low

// Find the maximum difference over the past 20 bars
maxDiff = ta.highest(diff, 20)

// Determine if the current bar has the maximum difference
isMaxDiffBar = diff == maxDiff

// Highlight the bar if it has the maximum difference
bgcolor(isMaxDiffBar ? color.red : na, transp=90)

// You might also want to plot the actual difference value for reference
plot(isMaxDiffBar ? diff : na, color=color.blue, style=plot.style_histogram, linewidth=1)
